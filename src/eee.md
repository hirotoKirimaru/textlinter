# echoコマンドで文字や背景を変更する

echoコマンドで出力する文字色や、背景色を変更できることを知っていましたか？こちらを覚えると、正常終了時には緑色で完了メッセージ、異常終了時には赤色で異常メッセージを出力することで、シェルの終了を視覚で検知することができます。
  
今回の記事では、echoコマンドで文字や背景を変更する方法について記載します。
  
# 環境
- Bash
- GitHub Codespaces
    - Linux version 5.4.0-1047-azure

# 方法

echoコマンドに、色のANSIエスケープシーケンスを入力すると、エスケープシーケンス以降の文字色・背景色を変更することができます。
  
```bash
echo -e "\e[31m赤い文字\e[m"
```
  
ToDo: 画像401。
  
# 解説
## 構文

文字色・背景色を変更する構文は以下の通りです。
  
```bash
ESC[{文字色・背景色のコード1;2;...}m
```
  
## コードについて

コードで指定できる色については、次の通りになります。
  
|文字色|背景色|色|
|---|---|---|
|30|40|黒|
|31|41|赤|
|32|42|緑|
|33|43|黄色|
|34|44|青|
|35|45|マゼンダ|
|36|46|シアン|
|37|47|白|
  
255色を指定したり、RGBを指定することもできますが、対応しているターミナルによって左右されるので、特に解説はしません。
  
文字を太字等にすることもできます。こちらもターミナルによって対応してないことがありますので、確認してから使ってください。
  
|コード|内容|
|---|---|
|0|指定をリセットし未指定状態に戻す（0は省略可）|
|1|太字|
|2|薄く表示|
|3|イタリック|
|4|アンダーライン|
|5|ブリンク|
|6|高速ブリンク|
|7|文字色と背景色の反転|
|8|表示を隠す（コピペ可能）|
|9|取り消し|
  
## 複数のコードを適用する

セミコロンで複数のコードを指定することができます。
  
```bash
echo -e "\e[31m赤文字で緑背景色"
echo -e "\e[31;1m赤文字で緑背景色"
echo -e "\e[31;42m赤文字で緑背景色"
```
  
ToDo:404。

## 有効範囲

この構文以降の文字色・背景色を変更します。例えば、次のコマンドでは「31」にて文字色を赤くします。次の「42」にて、文字色が赤のまま、背景色を緑に変更します。文字色等を何も指定しない=「0」が入力されている場合は、文字色・背景色がリセットされます。
  
```bash
echo -e "\e[31m赤い文字\e[42m緑の背景色\e[m文字色リセット"
```
  
ToDo:403。
  
基本的には、色を変更した後は最後にリセットしましょう。シェルで実行した際に、指定していない箇所まで色の変更がされてしまいます。
  
```bash
#!/bin/bash
echo -e "\e[31m赤色を指定"
echo "色を指定しない"
echo -e "\e[32m緑色を指定"
```
  
ToDo:405。
  
ただ、どこまでがコマンドで、どこからか文字か分かりづらくなってしまうので、メッセージを別ファイルにする、変数にする等で対応すると見やすくなるでしょう。Functionを作る方法も良いです。
  
```bash
echo -e "\e[33m$(cat result.txt)\e[m"
result=************完了しました***************
echo -e "\e[33m$result\e[m"
echo -e "\e[33m$(echo $result)\e[m"
```
ToDo:406。

## ESCを入力する方法
  
ESCを直接入力することは難しいので、「\e」や「\033」のどちらかで代用します。この記事では「\e」で統一します。次のコマンドは同じものを指します。
  
```bash
echo -e "\e[31m赤い文字\e[m"
echo -e "\033[31m赤い文字\033[m"
```
  
## -eオプションについて


echo のeオプションを付けることによって、ANSIエスケープシーケンスを解釈することができるようになります。
  
```bash
echo "\e[31m赤い文字\e[m"
```
  
ToDo: 画像402。
  
# ソースコード

[https://github.com/hirotoKirimaru/shell-practice/blob/main/200/main.sh:title]
  
[https://github.com/hirotoKirimaru/shell-practice/blob/main/200/test.sh:title]

# 終わりに

地味ながら、結果が分かりやすく表示できるのは嬉しいものです。まぁ、工数をかけてまで色を変更したい、なんて要望はないのですが。
  
個人の好みのターミナルの背景色とかありますから、万人に使いやすい色とかありませんしね。Linuxの操作をする際に1号機のターミナルは緑、2号機のターミナルは赤にする等で誤操作を行わないようにすることもあるので、なかなか難しいです。
  
ぜひシェルをちょっとでも快適にしたい時にご活用ください。
  
---

この記事がお役に立ちましたら、各種SNSでのシェアや、今後も情報発信しますので[フォロー](https://twitter.com/nainaistar)よろしくお願いします。

- [技術ブログはこちら](https://nainaistar.hatenablog.com)
- [雑記ブログはこちら](https://nainaistar.hateblo.jp)

# 参考

ANSIエスケープコード
[https://www.mm2d.net/main/prog/c/console-02.html:embed:cite]
  
シェル - echoで文字に色をつける その1
[http://site.m-bsys.com/linux/echo-color-1:embed:cite]
