# Excelで時刻を時間単位の数値に変更する（1:15 -> 1.25H）

自分の稼働計算しているときに、混乱したのでメモ。

# 環境

- Microsoft Office Home and Business 2019
    - Microsoft® Excel® 2019 MSO （16.0.14228.20216） 64 ビット 

# ユースケース

- 分単位の稼働を時間単位で計算したい
# 対応

時刻表示のまま、24を掛け算すると時間単位の数値に変換できます。

```bash
="1:15" * 24
# 1.25
```
   
24時間を超えた時刻表記でも正常に計算できます。
  
```bash
="24:15" * 24
# 24.25
```
  
注意点としては、セルの書式設定が標準にしておく必要があります。```時刻セル * 24```で計算すると、強制的に書式設定が```時刻セルの書式(h:mm)```になるので標準に戻してください。式を修正するだけで書式設定が```時刻セルの書式(h:mm)```に戻されてしまうので、もし変更する必要がある場合は書式設定も意識しましょう。
  
ToDo: 201。

# その他の計算方法（HOUR, MINUTE関数を使用）

こちらは時刻が24H以上の場合、正しく計算できないので非推奨です。
  
```bash
=HOUR("1:15")+(MINUTE("1:15")/60)	
# 1.25
```

```bash
=HOUR("24:25")+(MINUTE("24:25")/60)	
# 0.416666667
```

ToDo:202。

# 終わりに

セルの書式設定が計算元のセルで上書きされる仕様を認識していなかったせいで、地味に検証に時間がかかりました。普通に使っていれば、自動で単位をそろえてくれる素敵な仕様なのですが…。こういう時に厄介ですね。
  
もしかしたらLAMBDA関数を使うことで、セルの書式設定を意識せずに表現できるかもしれないです。しかし、LAMBDA関数の導入が「バージョン2108(ビルド14312.20008)以降」で私のEXCELが対応していませんので、他の方に検証をお任せすることにします。

---

この記事がお役に立ちましたら、各種SNSでのシェアや、今後も情報発信しますので[フォロー](https://twitter.com/nainaistar)よろしくお願いします。

- [技術ブログはこちら](https://nainaistar.hatenablog.com)
- [雑記ブログはこちら](https://nainaistar.hateblo.jp)

# 類似記事

ToDo: Excelで24H以上を表示する

# 参考記事

- [http://office-qa.com/Excel/ex109.htm:title]
